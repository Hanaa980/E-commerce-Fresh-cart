import{r as c,a as w,j as e,H as b}from"./index-C2O5eSQt.js";import{C as N}from"./ClipLoader-BfEd_EFM.js";class o extends Error{}o.prototype.name="InvalidTokenError";function v(r){return decodeURIComponent(atob(r).replace(/(.)/g,(s,l)=>{let a=l.charCodeAt(0).toString(16).toUpperCase();return a.length<2&&(a="0"+a),"%"+a}))}function y(r){let s=r.replace(/-/g,"+").replace(/_/g,"/");switch(s.length%4){case 0:break;case 2:s+="==";break;case 3:s+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return v(s)}catch{return atob(s)}}function P(r,s){if(typeof r!="string")throw new o("Invalid token specified: must be a string");s||(s={});const l=s.header===!0?0:1,a=r.split(".")[l];if(typeof a!="string")throw new o(`Invalid token specified: missing part #${l+1}`);let d;try{d=y(a)}catch(i){throw new o(`Invalid token specified: invalid base64 for part #${l+1} (${i.message})`)}try{return JSON.parse(d)}catch(i){throw new o(`Invalid token specified: invalid json for part #${l+1} (${i.message})`)}}function C(){const[r,s]=c.useState([]),[l,a]=c.useState(null),[d,i]=c.useState([]),[x,p]=c.useState(null),[u,h]=c.useState(!1);c.useEffect(()=>{const t=localStorage.getItem("u-token");if(t)try{const n=P(t);p(n==null?void 0:n.id)}catch{}},[]),c.useEffect(()=>{x&&j()},[x]);async function j(){h(!0);try{let{data:t}=await w.get(`https://ecommerce.routemisr.com/api/v1/orders/user/${x}`);s(t),h(!1)}catch{h(!1)}}const f=t=>{a(t._id),i(t.cartItems)},m=()=>{a(null),i([])};return e.jsxs(e.Fragment,{children:["  ",e.jsx(b,{children:e.jsx("title",{children:" Orders "})}),e.jsx("div",{className:"min-h-[80vh] relative mt-[70px]",children:u?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(N,{size:50,color:"#000"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-slate-500 flex justify-between w-full m-auto text-center ",children:[e.jsx("h2",{className:"text-xl w-[33%]",children:"Date"}),e.jsx("h2",{className:"text-xl w-[33%]",children:"Is Paid"}),e.jsx("h2",{className:"text-xl w-[33%]",children:"Order Price"})]}),r.length>0?r.map(t=>e.jsxs("div",{children:[e.jsxs("button",{className:"w-full py-5 flex justify-between",type:"button",onClick:()=>f(t),children:[e.jsx("span",{className:"w-[33%]",children:new Date(t.createdAt).toLocaleDateString()}),e.jsx("span",{className:"w-[33%]",children:t.isPaid?"Yes":"No"}),e.jsxs("span",{className:"w-[33%]",children:[t.totalOrderPrice," EGP"]})]}),l===t._id&&e.jsx("div",{className:"  py-5  flex flex-col items-center bg-black bg-opacity-50 ",children:e.jsxs("div",{className:" w-full px-2 max-w-2xl bg-white rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Order Details"}),e.jsx("button",{className:"text-gray-400 hover:text-gray-900",onClick:m,children:"âœ–"})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Order Date:"})," ",new Date(t.createdAt).toLocaleString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Payment Status:"})," ",t.isPaid?"Paid":"Not Paid"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total Price:"})," ",t.totalOrderPrice," EGP"]}),e.jsx("h3",{className:"text-md font-semibold mt-2",children:"Products in Cart:"}),e.jsx("ul",{className:" ml-5",children:d.length>0?d.map((n,g)=>e.jsxs("li",{className:"p-2 flex items-center border-b",children:[e.jsx("img",{src:n.product.imageCover,className:"w-[100px]",alt:""}),e.jsxs("div",{className:"",children:[" ",e.jsxs("p",{children:[e.jsx("strong",{children:"Product Name:"})," ",n.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Quantity:"})," ",n.quantity]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Price:"})," ",n.price," EGP"]})]})]},g)):e.jsx("p",{children:"No items in the cart."})})]}),e.jsx("div",{className:"flex justify-end p-4 border-t",children:e.jsx("button",{className:"bg-main text-white px-4 py-2 rounded-md",onClick:m,children:"Close"})})]})})]},t._id)):e.jsx("p",{className:"text-center p-5",children:"No orders available."})]})})]})}export{C as default};
